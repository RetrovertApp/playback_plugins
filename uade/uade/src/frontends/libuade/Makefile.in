LIBDIR = $(DESTDIR){PACKAGEPREFIX}{LIBDIR}
INCLUDEDIR = $(DESTDIR){PACKAGEPREFIX}{INCLUDEDIR}
PKGCONFIGDIR = $(DESTDIR){PACKAGEPREFIX}{PKGCONFIGDIR}
SHAREDSUFFIX = {SHAREDSUFFIX}

AR = {AR}
CC = {CC}
CLIBS = {ARCHLIBS} -lm {BENCODETOOLSLIBS} {ZAKALWELIBS}
CFLAGS = -Wall -O2 -I../include -I../common -fPIC {SHAREDLIBRARYFLAGS} {DEBUGFLAGS} {ARCHFLAGS} {BENCODETOOLSFLAGS} {ZAKALWEFLAGS}

all:	libuade.$(SHAREDSUFFIX) libuade.a

%.o:	%.c
	$(CC) $(CFLAGS) -c $<

include ../common/Makefile.common

libuade.$(SHAREDSUFFIX):	$(COMMONMODULES)
	$(CC) {SHAREDNAMEFLAG} {SHAREDFLAG} -o $@ $(COMMONMODULES) $(CLIBS)

libuade.a:	$(COMMONMODULES)
	$(AR) rcs $@ $(COMMONMODULES)

install:	libuade.$(SHAREDSUFFIX)
	mkdir -p "$(INCLUDEDIR)"/uade "$(LIBDIR)" "$(PKGCONFIGDIR)"
	install -m 644 $< "$(LIBDIR)"/
	install -m 644 ../include/uade/options.h ../include/uade/uade.h ../include/uade/uadeconfstructure.h "$(INCLUDEDIR)"/uade/
	install -m 644 ../../../libuade.pc "$(PKGCONFIGDIR)"/

clean:	
	rm -f *.o *.so *.a

check:	all

installcheck:	check

distclean:	clean
